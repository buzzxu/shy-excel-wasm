<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="static/index.js"></script>
</head>
<body>
<div>
    <button onclick="download()">下载1</button>
</div>
<script>
    function download() {
        shyexcelWASM.init("./static/shyexcel.wasm.gz")
            .then((shyexcel)=>{
                console.info(shyexcel)
                fetch('./static/example.json').then((response) => response.json()).then((json) => {
                    const f = shyexcel.NewTable(json);
                    const { buffer, error } = f.WriteToBuffer();
                    if (error) {
                        console.log(error);
                        return;
                    }
                    const link = document.createElement('a');
                    link.download = 'Book1.xlsx';
                    link.href = URL.createObjectURL(
                        new Blob([buffer], {
                            type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
                        })
                    );
                    link.click();
                });

            });
    }
</script>
</body>
</html>