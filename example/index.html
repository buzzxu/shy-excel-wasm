<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../dist/index.js"></script>
</head>
<body>
<div>
    <button onclick="download()">下载1</button>
</div>
<script>
    function download() {
        var shyexcelOpts = {
            method:'GET',
            headers:{
                'Authorization':'eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ4d2pkLnhpbmdjaGVuZ2EueHl6Iiwic3ViIjoiNiIsImlhdCI6MTcwMTM1MDAwNywiZXhwIjoxNzAxOTU0ODA3LCJ0eXBlIjoxMCwidXNlck5hbWUiOm51bGwsInJlZ2lvbiI6MTAsIm1vYmlsZSI6IjE4MCoqKio4MDg4IiwiYXZhdGFyIjoiIiwic2V4IjowLCJuYW1lIjoiJUU4JUI1JUI1JUU1JUE0JUE3JUU1JUE0JUE3In0.suEjvveuab27JdRHKg3UbwOoxXP1OZqv-tU3BNXvKB2g5k93c_G_LLNAciIMRslY--5QfG1ehL1Yf-7qaE65-A'
            },
            responseType: 'json',  //默认json 可选属性，非必填
            timeout: 1000*10,  //请求超时时间
            handleData: data=>{
                if(data.error){
                    throw new Error(data.message);
                }
                return data;
            }
        };
        try {
            shyexcelWASM.NewTable(shyexcelOpts).export('a.xlsx','https://api.mgr.xwjd.xingchenga.xyz/mall/decorate/order/shy/export',{
                // startTime: undefined,
                // endTime:undefined
            });
        }catch (error){
            console.error(error)
        }


    }

</script>
</body>
</html>