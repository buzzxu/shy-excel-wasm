<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../dist/index.js"></script>
</head>
<body>
<div>
    <button onclick="download()">下载1</button>
</div>
<script>
    function download() {
        var shyexcelOpts = {
            method:'GET',
            headers:{
                'Authorization':'eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ4d2pkLnhpbmdjaGVuZ2EueHl6Iiwic3ViIjoiMTE4IiwiaWF0IjoxNzA5MDA4OTEyLCJleHAiOjE3MDk2MTM3MTIsInR5cGUiOjEsInVzZXJOYW1lIjoidGVuYW50IiwicmVnaW9uIjozLCJtb2JpbGUiOiIiLCJhdmF0YXIiOiIiLCJzZXgiOjAsIm5hbWUiOiIlRTclQUUlQTElRTclOTAlODYlRTUlOTElOTgifQ.x3XjgcxQe78VgxGTYv7aVvn8tMjkUD07ryA1AtivJjQiqopi_aN9HsaPDaCWarceGi6Bn74Xmrr5JqeKsjnODQ'
            },
            timeout: 1000*10,  //请求超时时间
            handleData: data=>{
                if(data.error){
                    throw new Error(data.message);
                }
                return data;
            }
        };
        try {
            shyexcelWASM.NewTable(shyexcelOpts).export('a.xlsx','http://127.0.0.1:8089/mall/order/shy/export',{
                startTime: '2023-01-01',
                endTime:'2023-01-30'
            });
        }catch (error){
            console.error(error)
        }


    }

</script>
</body>
</html>